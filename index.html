<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Emoji Story Cubes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f2f5fa;
      font-family: 'Segoe UI', Arial, sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 0;
      margin: 0;
    }
    h1 {
      font-size: 1.4rem;
      margin-top: 1.1rem;
      margin-bottom: 0.4rem;
      letter-spacing: 2px;
      color: #285388;
      font-weight: 700;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 20vw);
      grid-gap: 3vw;
      justify-content: center;
      align-items: center;
      margin: 2.2vw auto 1.5vw auto;
      background: #dde7f1;
      padding: 3vw;
      border-radius: 2.2vw;
      box-shadow: 0 4px 32px #a3bed6aa;
      width: max-content;
      max-width: 98vw;
      min-width: 63vw;
    }
    .tile-flip {
      perspective: 700px;
    }
    .tile-inner {
      width: 20vw;
      height: 20vw;
      max-width: 120px;
      max-height: 120px;
      min-width: 70px;
      min-height: 70px;
      border-radius: 1.5vw;
      position: relative;
      transition: transform 0.48s cubic-bezier(0.5,0.2,0.1,1.05);
      transform-style: preserve-3d;
      will-change: transform;
      box-shadow: 0 1.5px 7px #d1dbec99;
      border: 1.5px solid #c0d3e5;
      background: transparent;
      touch-action: none;
      user-select: none;
    }
    .tile-flip.flipped .tile-inner {
      transform: rotateY(180deg);
    }
    .tile-face {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 9vw;
      max-font-size: 80px;
      min-font-size: 38px;
      border-radius: 1.2vw;
      background: linear-gradient(135deg, #fff 75%, #e6f0fa 100%);
      box-shadow: 0 2px 10px #d1dbec99;
      backface-visibility: hidden;
      user-select: none;
    }
    .tile-back {
      transform: rotateY(180deg);
      background: linear-gradient(135deg, #b0cced 70%, #dde7f1 100%);
      color: #a2bed8;
      font-size: 4vw;
      letter-spacing: 2px;
    }
    .chapter-label {
      grid-column: 1 / 4;
      text-align: left;
      font-size: 1.05rem;
      color: #487cc7;
      margin-top: 3px;
      margin-bottom: -10px;
      padding-left: 5px;
      font-weight: 600;
      letter-spacing: 1px;
      background: none;
      border: none;
      outline: none;
      pointer-events: none;
      user-select: none;
    }
    .button-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.6vw;
      margin-top: 2vw;
      margin-bottom: 1.3rem;
    }
    button {
      font-size: 1.13rem;
      padding: 0.78rem 2.2rem;
      border-radius: 2rem;
      border: none;
      background: linear-gradient(90deg, #2b74e4, #52aaff 90%);
      color: #fff;
      cursor: pointer;
      box-shadow: 0 2px 12px #c6e1ff55;
      font-weight: 700;
      letter-spacing: 1.5px;
      transition: background 0.2s, box-shadow 0.2s;
      margin: 0;
      min-width: 120px;
      min-height: 46px;
      outline: none;
      -webkit-tap-highlight-color: transparent;
    }
    button:active {
      background: linear-gradient(90deg, #3063bc, #7cc5fa 90%);
      box-shadow: 0 2px 15px #8ec9fd99;
    }
    button:disabled {
      background: #b3c6dd;
      color: #eef1f5;
      cursor: not-allowed;
      box-shadow: none;
    }
    .hint {
      color:#6987ad;
      font-size:1rem;
      margin-bottom:2vw;
      padding:0 10vw;
      font-weight: 400;
      letter-spacing: 0.5px;
    }
    @media (max-width: 700px) {
      h1 { font-size: 1.05rem; }
      .grid {
        grid-template-columns: repeat(3, 28vw);
        min-width: 84vw;
        padding: 2.5vw;
      }
      .tile-inner, .tile-flip {
        min-width: 54px;
        min-height: 54px;
        width: 28vw;
        height: 28vw;
      }
      .tile-face { font-size: 13vw; }
      button { font-size: 1.01rem; padding: 0.6rem 1.3rem; min-width:90px; min-height:36px; }
      .button-row { gap: 3vw; }
      .hint { font-size: .92rem; }
    }
    @media (max-width: 420px) {
      .grid { grid-template-columns: repeat(3, 31vw); }
      .tile-inner, .tile-flip {
        width: 31vw;
        height: 31vw;
        min-width: 44px;
        min-height: 44px;
      }
      .tile-face { font-size: 16vw; }
    }
    /* Remove highlight on tap for a more app-like feel */
    button, .tile-inner, .tile-flip {
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>
<body>
  <h1>Emoji Story Cubes ğŸ²</h1>
  <div id="emojiGrid" class="grid"></div>
  <div class="button-row">
    <button id="rollBtn" onclick="rollStoryCubes()">Roll Again</button>
    <button onclick="copyEmojis()">Copy Emojis</button>
  </div>
  <div class="hint">
    Tell a story using the emojis! Each row is a new chapter.<br>(Tap â€œRoll Againâ€ for new inspiration)
  </div>

  <script>
    const EMOJIS = [
      "ğŸ˜€","ğŸ˜¢","ğŸ˜±","ğŸ˜¡","ğŸ˜´","ğŸ¤”","ğŸ˜","ğŸ¥³","ğŸ¤—","ğŸ˜œ","ğŸ˜­","ğŸ˜‡","ğŸ¤©","ğŸ˜","ğŸ˜¬","ğŸ˜¤","ğŸ¤ª","ğŸ˜®â€ğŸ’¨","ğŸ˜¶â€ğŸŒ«ï¸","ğŸ˜ˆ",
      "ğŸ¶","ğŸ¦","ğŸ¦‰","ğŸŸ","ğŸ¦Š","ğŸ¸","ğŸ˜","ğŸ¦–","ğŸ¦„","ğŸ’","ğŸ¦‹","ğŸ¢",
      "ğŸ—ï¸","ğŸ•°ï¸","ğŸ’","ğŸ“š","ğŸ”‘","ğŸ”¦","ğŸ–Šï¸","ğŸ“·","ğŸ§¸","ğŸª","ğŸª€","ğŸ›ï¸",
      "ğŸŒ§ï¸","â˜€ï¸","ğŸŒªï¸","ğŸŒˆ","ğŸŒ™","ğŸŒ»","ğŸ‚","ğŸŒ²","ğŸŒŠ","ğŸŒ‹",
      "ğŸš—","ğŸš²","ğŸš€","ğŸš‚","ğŸš","ğŸš¤","ğŸšœ","ğŸ›´","ğŸ›¸",
      "ğŸ ","ğŸï¸","ğŸ«","ğŸ•ï¸","ğŸ°","ğŸŸï¸","ğŸï¸","ğŸ¥",
      "ğŸ‰","ğŸ§™â€â™‚ï¸","ğŸ§šâ€â™€ï¸","ğŸ§›â€â™‚ï¸","ğŸ§â€â™‚ï¸","ğŸ§œâ€â™€ï¸","ğŸ¦¸â€â™‚ï¸","ğŸ¦¹â€â™€ï¸",
      "ğŸ","ğŸ•","ğŸ¦","ğŸ”","ğŸ‰","ğŸ©","ğŸª","ğŸ§ƒ","ğŸ“","ğŸŸ"
    ];

    let currentStoryCubes = [];
    let flipping = false;

    function randomGrid() {
      let set = [...EMOJIS];
      let grid = [];
      for (let i = 0; i < 9; i++) {
        let idx = Math.floor(Math.random() * set.length);
        grid.push(set.splice(idx, 1)[0]);
      }
      return grid;
    }

    function renderGrid(grid, showBack = false) {
      const gridDiv = document.getElementById("emojiGrid");
      gridDiv.innerHTML = "";
      for (let row = 0; row < 3; row++) {
        // Chapter label
        const label = document.createElement("div");
        label.className = "chapter-label";
        label.textContent = "Chapter " + (row + 1);
        gridDiv.appendChild(label);
        for (let col = 0; col < 3; col++) {
          const idx = row * 3 + col;
          const tileFlip = document.createElement("div");
          tileFlip.className = "tile-flip";
          if (showBack) tileFlip.classList.add("flipped");
          tileFlip.dataset.row = row;
          tileFlip.dataset.idx = idx;

          // Inner for flipping faces
          const tileInner = document.createElement("div");
          tileInner.className = "tile-inner";

          // Front face
          const tileFront = document.createElement("div");
          tileFront.className = "tile-face tile-front";
          tileFront.textContent = grid[idx];

          // Back face (shows a generic "?" or old emoji)
          const tileBack = document.createElement("div");
          tileBack.className = "tile-face tile-back";
          tileBack.textContent = "ğŸ²";

          tileInner.appendChild(tileFront);
          tileInner.appendChild(tileBack);
          tileFlip.appendChild(tileInner);
          gridDiv.appendChild(tileFlip);
        }
      }
    }

    function rollStoryCubes() {
      if (flipping) return;
      flipping = true;
      document.getElementById('rollBtn').disabled = true;

      // Stage 1: Flip all to back
      const gridDiv = document.getElementById("emojiGrid");
      const tiles = [...gridDiv.querySelectorAll('.tile-flip')];
      for (let i = 0; i < tiles.length; i++) {
        tiles[i].classList.add('flipped');
      }

      // Prepare new grid to flip to
      const newGrid = randomGrid();
      // After each row, flip to front with new emoji
      for (let row = 0; row < 3; row++) {
        setTimeout(() => {
          for (let col = 0; col < 3; col++) {
            const idx = row * 3 + col;
            const tileFlip = gridDiv.querySelector(`.tile-flip[data-row="${row}"][data-idx="${idx}"]`);
            if (tileFlip) {
              // Update emoji on front face before unflipping
              tileFlip.querySelector('.tile-front').textContent = newGrid[idx];
              tileFlip.classList.remove('flipped');
            }
          }
        }, 380 + row * 320);
      }

      setTimeout(() => {
        flipping = false;
        currentStoryCubes = newGrid;
        document.getElementById('rollBtn').disabled = false;
      }, 1350);
    }

    function copyEmojis() {
      const g = currentStoryCubes;
      if (!g || g.length !== 9) return;
      const text =
        `Chapter 1: ${g.slice(0,3).join(" ")}\n` +
        `Chapter 2: ${g.slice(3,6).join(" ")}\n` +
        `Chapter 3: ${g.slice(6,9).join(" ")}`;
      navigator.clipboard.writeText(text);
      alert("Copied to clipboard!");
    }

    // First render on load
    window.onload = function() {
      currentStoryCubes = randomGrid();
      renderGrid(currentStoryCubes);
    };
  </script>
</body>
</html>
